# Быстрая настройка VM в UTM

## Шаг 1: Создание VM в UTM

1. **Откройте UTM** (уже установлен)

2. **Нажмите "Create a New Virtual Machine"**

3. **Выберите:**
   - **Virtualize** → **Linux**

4. **Настройки VM:**
   - **Name:** `ubuntu-troubleshooting`
   - **Architecture:** `ARM64 (aarch64)`
   - **System:** `Generic`
   - **Memory:** `2048 MB`
   - **CPU Cores:** `2`

5. **Настройки диска:**
   - **Storage:** `20 GB`
   - **Interface:** `VirtIO`

6. **Настройки сети:**
   - **Network:** `Shared Network`

7. **Настройки загрузки:**
   - **Boot ISO:** Выберите файл `ubuntu-22.04.3-live-server-arm64.iso`

8. **Нажмите "Save"**

## Шаг 2: Установка Ubuntu Server

1. **Запустите VM**

2. **При установке используйте:**
   - **Language:** English
   - **Keyboard:** US
   - **Network:** DHCP (автоматически)
   - **Hostname:** `ubuntu`
   - **User:** `ubuntu`
   - **Password:** `ubuntu`
   - **Disk partitioning:** Use entire disk (LVM)
   - **Install OpenSSH server:** ✅ Да
   - **Install additional packages:** Оставить пустым

## Шаг 3: Автоматическая настройка

После установки и перезагрузки:

1. **Войдите в систему** (ubuntu/ubuntu)

2. **Скопируйте скрипт настройки:**
   ```bash
   # В терминале Mac (не в VM)
   scp setup-vm.sh ubuntu@[IP_VM]:/home/ubuntu/
   ```

3. **Запустите скрипт в VM:**
   ```bash
   chmod +x setup-vm.sh
   ./setup-vm.sh
   ```

## Шаг 4: Копирование файлов проекта

1. **Скопируйте файлы проекта на VM:**
   ```bash
   # В терминале Mac
   scp -r . ubuntu@[IP_VM]:/home/ubuntu/troubleshoot-vm/
   ```

2. **В VM запустите Ansible:**
   ```bash
   cd troubleshoot-vm
   ansible-galaxy install -r requirements.yml
   ansible-playbook -i localhost, -c local playbook.yml
   ```

## Шаг 5: Экспорт готового образа

1. **Остановите VM**

2. **В UTM выберите VM** → **"Export"**

3. **Выберите формат:** `UTM Package (.utm)`

4. **Сохраните файл**

## Готово! 

Теперь у вас есть готовый образ VM для обучения системных администраторов с предустановленными проблемами для траблшутинга.
