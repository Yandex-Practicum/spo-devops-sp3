# Ручная сборка образа VM для VirtualBox

Поскольку автоматическая сборка через Packer может вызывать проблемы, вот инструкция для ручного создания образа.

## Шаг 1: Создание базовой VM в VirtualBox

1. Откройте VirtualBox
2. Создайте новую VM:
   - Имя: `ubuntu-troubleshooting`
   - Тип: Linux
   - Версия: Ubuntu (64-bit)
   - Память: 2048 MB
   - Процессоры: 2
   - Жесткий диск: 20 GB

## Шаг 2: Установка Ubuntu

1. Скачайте Ubuntu 22.04.3 Server ISO:
   ```
   https://old-releases.ubuntu.com/releases/22.04.3/ubuntu-22.04.3-live-server-amd64.iso
   ```

2. Подключите ISO к VM и запустите установку

3. При установке используйте следующие настройки:
   - Язык: English
   - Раскладка клавиатуры: US
   - Сетевое подключение: DHCP
   - Имя хоста: ubuntu
   - Пользователь: ubuntu
   - Пароль: ubuntu
   - Разметка диска: Use entire disk (LVM)
   - Установить OpenSSH server: Да

## Шаг 3: Настройка SSH

После установки войдите в систему и настройте SSH:

```bash
sudo systemctl enable ssh
sudo systemctl start ssh
```

## Шаг 4: Установка зависимостей

```bash
sudo apt update
sudo apt install -y python3 python3-pip git curl wget vim htop
sudo ln -sf /usr/bin/python3 /usr/bin/python
```

## Шаг 5: Настройка sudo

```bash
echo 'ubuntu ALL=(ALL) NOPASSWD:ALL' | sudo tee /etc/sudoers.d/ubuntu
sudo chmod 440 /etc/sudoers.d/ubuntu
```

## Шаг 6: Применение Ansible playbook

1. Скопируйте файлы проекта на VM или клонируйте репозиторий

2. Установите зависимости Ansible:
   ```bash
   ansible-galaxy install -r requirements.yml
   ```

3. Запустите playbook:
   ```bash
   ansible-playbook -i localhost, -c local playbook.yml
   ```

## Шаг 7: Экспорт образа

1. Остановите VM
2. В VirtualBox выберите VM → File → Export Appliance
3. Выберите формат OVA
4. Сохраните файл

## Альтернативный способ: Использование готового образа

Если у вас есть доступ к готовому образу, вы можете:

1. Импортировать .ova файл в VirtualBox
2. Запустить VM
3. Войти с учетными данными ubuntu/ubuntu
